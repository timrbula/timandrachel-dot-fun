---
import BaseLayout from "../../components/astro/BaseLayout.astro";
import Marquee from "../../components/react/Marquee";
import BlinkingText from "../../components/react/BlinkingText";
import RainbowDivider from "../../components/react/RainbowDivider";
import GeoButton from "../../components/react/GeoButton";
import RSVPEditForm from "../../components/react/RSVPEditForm";

// Get token from URL query params
const url = new URL(Astro.request.url);
const token = url.searchParams.get("token");
---

<BaseLayout
  title="Edit RSVP - Rachel & Tim ğŸ’Œ"
  description="Edit your wedding RSVP"
>
  <!-- Top Marquee -->
  <Marquee client:load speed={15}>
    âœï¸ Edit Your RSVP âœï¸ Make changes to your response
  </Marquee>

  <div class="container">
    <!-- Page Header -->
    <section class="page-header text-center">
      <h1 class="text-3d">
        <BlinkingText client:load speed="slow">âœï¸</BlinkingText>
        Edit Your RSVP
        <BlinkingText client:load speed="slow">âœï¸</BlinkingText>
      </h1>
      <p class="subtitle">Update your wedding response</p>
    </section>

    <RainbowDivider client:load variant="animated" />

    <!-- Edit Form Container -->
    <section class="form-section">
      <div class="form-container geo-box-raised">
        <h2 class="text-center text-3d">
          <BlinkingText client:load>âœ¨</BlinkingText>
          Update Your Response
          <BlinkingText client:load>âœ¨</BlinkingText>
        </h2>

        <!-- React component handles all loading, error, and form states -->
        <RSVPEditForm client:load token={token || ""} />
      </div>
    </section>

    <RainbowDivider client:load variant="solid" />

    <!-- Help Section -->
    <section class="help-section">
      <div class="help-box geo-box-neon text-center">
        <h2 class="text-3d">
          <BlinkingText client:load>ğŸ’¬</BlinkingText>
          Need Help?
          <BlinkingText client:load>ğŸ’¬</BlinkingText>
        </h2>
        <p>
          If you're having trouble editing your RSVP, please reach out to us:
        </p>
        <p>
          ğŸ“§ Email: <a href="mailto:hello@rachelandtim.fun" class="text-cyan"
            >hello@rachelandtim.fun</a
          >
        </p>
      </div>
    </section>
  </div>

  <!-- Bottom Marquee -->
  <Marquee client:load speed={20} direction="right">
    ğŸ’• Thanks for updating your RSVP! ğŸ‰
  </Marquee>
</BaseLayout>

<style>
  /* Page Header */
  .page-header {
    padding: 2rem 0;
  }

  .page-header h1 {
    font-size: 3.5rem;
    margin-bottom: 1rem;
  }

  .subtitle {
    font-size: 1.3rem;
    max-width: 700px;
    margin: 0 auto;
  }

  /* Form Section */
  .form-section {
    margin: 3rem 0;
  }

  .form-container {
    max-width: 800px;
    margin: 0 auto;
    padding: 2.5rem;
  }

  .form-container h2 {
    margin-bottom: 2rem;
  }

  /* Help Section */
  .help-section {
    margin: 3rem 0;
  }

  .help-box {
    max-width: 700px;
    margin: 0 auto;
    padding: 2.5rem;
  }

  .help-box p {
    margin-bottom: 1rem;
    font-size: 1.1rem;
  }

  /* Links */
  a {
    text-decoration: underline;
  }

  a:hover {
    opacity: 0.8;
  }

  /* Responsive */
  @media (max-width: 768px) {
    .page-header h1 {
      font-size: 2.5rem;
    }

    .subtitle {
      font-size: 1.1rem;
    }
  }
</style>
